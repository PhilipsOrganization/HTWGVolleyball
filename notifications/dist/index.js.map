{"version":3,"sources":["../src/notification.ts"],"sourcesContent":["import type { User } from '@lib/database';\nimport webpush from 'web-push';\n\nlet publicVapidKey: string;\nlet privateVapidKey: string;\n\nexport function setEnv(env: any) {\n\tpublicVapidKey = env.VITE_VAPID_PUBLIC;\n\tprivateVapidKey = env.VAPID_PRIVATE;\n\n\tif (!publicVapidKey || !privateVapidKey) {\n\t\tthrow new Error('VAPID keys not set');\n\t}\n\n\twebpush.setVapidDetails('https://volleyballhtwg.netlify.app', publicVapidKey, privateVapidKey);\n}\n\n\nexport async function sendNotification(user: User, payload: string) {\n\tconst subscription = user.subscription;\n\n\tif (!subscription) {\n\t\treturn;\n\t}\n\n\tawait webpush.sendNotification(subscription.toJSON(), JSON.stringify({ title: payload }));\n}\n"],"mappings":";AACA,OAAO,aAAa;AAEpB,IAAI;AACJ,IAAI;AAEG,SAAS,OAAO,KAAU;AAChC,mBAAiB,IAAI;AACrB,oBAAkB,IAAI;AAEtB,MAAI,CAAC,kBAAkB,CAAC,iBAAiB;AACxC,UAAM,IAAI,MAAM,oBAAoB;AAAA,EACrC;AAEA,UAAQ,gBAAgB,sCAAsC,gBAAgB,eAAe;AAC9F;AAGA,eAAsB,iBAAiB,MAAY,SAAiB;AACnE,QAAM,eAAe,KAAK;AAE1B,MAAI,CAAC,cAAc;AAClB;AAAA,EACD;AAEA,QAAM,QAAQ,iBAAiB,aAAa,OAAO,GAAG,KAAK,UAAU,EAAE,OAAO,QAAQ,CAAC,CAAC;AACzF;","names":[]}